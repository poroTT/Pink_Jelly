<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout/basic.html}">
<head>
    <meta charset="UTF-8">
    <title>메인 페이지</title>
    <link rel="stylesheet" th:href="@{/css/mainBoard.css}">
</head>
<body>
    <div layout:fragment="content">
<!--        검색 창-->
        <form action="/main" method="get" name="frmSearch">
            <div class="col">
                <input type="hidden" name="size" th:value="${pageRequestDTO.size}">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <select class="form-select" id="type">
                            <option value="">---</option>
                            <option value="title" >제목</option>
                            <option value="content">내용</option>
                            <option value="nickName" >닉네임</option>
                            <option value="memberId">아이디</option>
                        </select>
                    </div>
                    <input type="text" class="form-control" id="keyword">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary searchBtn" type="button">Search</button>
                        <button class="btn btn-outline-secondary clearBtn" type="button">Clear</button>
                    </div>
                </div>
            </div>
        </form>

        <div class="row mb-4">
            <div class="col-sm-6">
                <h2 class="posts-entry-title">Pink Jelly</h2>
            </div>
            <div class="col-sm-6 text-sm-end"><a href="category.html" class="read-more">View All</a></div>
            <a th:href="|@{/main/write}|" class="btn btn-primary">글쓰기</a>
        </div>

        <div class="row">
            <div class="col-lg-4 mb-4" th:each="mainBoard:${mainBoardList.dtoList}">
                <div class="post-entry-alt">
                    <a th:href="|@{/main/view(mbNo=${mainBoard.mbNo})}|" class="img-link"><img th:src="|/upload/mainBoardView/${mainBoard.mainImg[0]}|" alt="Image" class="img-fluid"></a>
                    <div class="excerpt">
                        <h2><a th:href="|@{/main/view(mbNo=${mainBoard.mbNo})}|">[[${mainBoard.title}]]</a></h2>
                        <p>[[${mainBoard.content}]]</p>
                        <div class="post-meta align-items-center text-left clearfix">
                            <figure class="author-figure mb-0 me-3 float-start"><img src="/images/person_1.jpg" alt="Image" class="img-fluid"></figure>
                            <a th:href="|@{/main/view(mbNo=${mainBoard.mbNo})}|"><span class="d-inline-block mt-1 boardNickName">[[${mainBoard.nickName}]]</span><span class="boardMemberId">([[${mainBoard.memberId}]])</span> </a>
                            <span>[[${#temporals.format(mainBoard.addDate, 'yyyy-MM-dd HH:mm')}]]</span><br>
                            <p class="likeHitCnt"><span>Like</span><span>hit</span><span>commentCnt</span><br></p>
                            <p class="likeHitCnt"><span>[[${mainBoard.like}]] /</span><span>[[${mainBoard.hit}]] /</span><span>[[${mainBoard.commentCnt}]]</span></p>
                        </div>
                        <p><a href="#" class="read-more">Continue Reading</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script layout:fragment="script" th:inline="javascript">
    // 검색 기능
    const searchBtn = document.querySelector('.searchBtn');
    const frmSearch = document.querySelector('form[name=frmSearch]');
    const clearBtn = document.querySelector('.clearBtn');

    searchBtn.addEventListener('click', function (e){
        e.preventDefault()
        e.stopPropagation();

        const page = 1;
        const type = document.getElementById('type').value;
        console.log(type);
        const keyword = document.getElementById('keyword').value;
        console.log(keyword);
        frmSearch.innerHTML += `<input type='hidden' name='page' value='${page}'>`;
        frmSearch.innerHTML += `<input type='hidden' name='type' value='${type}'>`;
        frmSearch.innerHTML += `<input type='hidden' name='keyword' value='${keyword}'>`;
        frmSearch.submit();
    })

    clearBtn.addEventListener('click', function (e){
        e.preventDefault();
        e.stopPropagation();

        self.location='/main';
    })
</script>
</body>
</html>